{% extends "base.html" %}
{% block content %}
<section class="card">
  <h2>Sites Map</h2>
  <div id="map" style="height: 520px;"></div>
  {% if not MAPTILER_KEY %}
    <p class="warn">MAPTILER_KEY env var is missing. Add it in Render to load satellite tiles.</p>
  {% endif %}
</section>
{% endblock %}

{% block extra_scripts %}
<script>
  const map = L.map('map').setView([39.73, -121.99], 9);

  L.tileLayer(
    "https://api.maptiler.com/maps/satellite/{z}/{x}/{y}.jpg?key={{ MAPTILER_KEY }}",
    {
      tileSize: 512,
      zoomOffset: -1,
      attribution:
        '&copy; <a href="https://www.maptiler.com/">MapTiler</a> | Â© OpenStreetMap contributors'
    }
  ).addTo(map);

  const demoSites = [
    {name:"Corning Site A",  lat:39.927, lng:-122.179},
    {name:"Orland Site B",   lat:39.747, lng:-122.195},
    {name:"Chico Site C",    lat:39.728, lng:-121.837},
    {name:"Cottonwood D",    lat:40.386, lng:-122.279},
    {name:"Durham E",        lat:39.646, lng:-121.802}
  ];
  demoSites.forEach(s => L.marker([s.lat, s.lng]).addTo(map).bindPopup(s.name));
</script>
{% endblock %}